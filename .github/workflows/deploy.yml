name: Deploy to GitHub Pages

on:
  # å½“ä»£ç æ¨é€åˆ° main åˆ†æ”¯æ—¶è§¦å‘ (å¦‚æœæ˜¯ master åˆ†æ”¯ï¼Œè¯·æ”¹ä¸º master)
  push:
    branches: [ main ]
  
  # å…è®¸åœ¨ Actions é¡µé¢æ‰‹åŠ¨è§¦å‘
  workflow_dispatch:

permissions:
  contents: write

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    
    steps:
      # 1. æ‹‰å–ä»£ç 
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v4

      # 2. å®‰è£… Node.js
      - name: Setup Node.js âš™ï¸
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: 'npm'

      # 3. å®‰è£…ä¾èµ–
      - name: Install and Build ğŸ”§
        run: |
          npm install
          npm run build
        # æ³¨æ„ï¼šè¿™é‡Œä¼šè¿è¡Œ package.json ä¸­çš„ build å‘½ä»¤ (tsc && vite build)
        # ç”Ÿæˆçš„æ–‡ä»¶ä¼šé»˜è®¤æ”¾åœ¨ dist æ–‡ä»¶å¤¹ä¸­

      # 4. éƒ¨ç½²åˆ° gh-pages åˆ†æ”¯ ğŸš€
      - name: Deploy ğŸš€
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: dist # Vite é»˜è®¤æ‰“åŒ…ç›®å½•
          branch: gh-pages # éƒ¨ç½²åˆ°çš„åˆ†æ”¯